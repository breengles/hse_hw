%!TEX root = kotov.tex
\section{Task 3}
\begin{task}
    Найдите лексикографически минимальный из всех топологических порядков. $V, E \leq 10^6$.
\end{task}

\begin{solution}
    Так-с, итерация номер\dots

    Рассмотрим множество всех вершин.
    Посчитаем степень входящих ребер для каждой вершины, в целом, для этого нам надо будет взять вершину и посчитать количество всех входящих ребер, в худшем случае такое нам будет стоить $\O(V + E)$.

    Теперь создадим мин-кучу в лексикографическом смысле.
    Поместим в кучу все вершины с нулевой входящей степенью (назовем такие вершины истоки).

    Теперь, чтобы гарантировать, что мы берем минимальный в лексикографическом смысле вершины, будем брать минимальный элемент из кучи (\texttt{extract\_min}), обозвем его текущей вершиной.
    Для текущей вершины, во-первых, добавим ее в качестве очередной вершины топсорта, во-вторых, вычтем из каждой соседней с ней вершины $1$ из входящей степени (то есть из тех вершин, в которые есть выходящее ребро из текущей вершины), если в процессе возникают вершины, у которых входящая степень стала равна $0$, то добавляем их в мин-кучу из истоков, так как эта вершина --- новый исток.
    \begin{remark}
        В простом варианте топологической сортировки мы помещали истоки в очередь.
    \end{remark}
    Затем, когда мы перебрали все соседние вершины текущей вершины, мы берем опять минимум из кучи и повторяем процедуру, так будет происходит пока куча не окажется пустой (в целом, это произойдет, когда все вершины не пройдут через кучу).

    В худшем варианте, мы будем иметь кучу на $V$ элементах, следовательно, каждая операция добавления новой вершины и удаления минимальной вершины будет стоить нам $\O(\log V)$.
    Всего вершин $V \Longrightarrow $ в итоге (с учетом просмотра выходящих ребер) будем иметь сложность $\O(\underbrace{V\log V}_{\text{heap}} + E)$
\end{solution}
